# MasterCode

### 版本内容更新 

#### V 0.2.0更新

1. 增加深度休眠。无人时5s休眠一次，检测是否有人就坐，判断是否再次进入休眠。

2. 修改初始化时的延迟为100ms

#### V0.2.1更新

1. 修正了一点bug，增加串口打印获取的数据，

#### V0.2.2更新

1. 61行改正为设置为STA模式

2. 删除64行的“省电模式设置为不省电”

#### V0.2.3更新

1. 在进入休眠2之前，添加了将压力值设为0并发送给主站。修复了直接进入休眠后，主站数据保留最后一次的数据，导致不会归零的bug。

2. 删除了设置wifi接入信息（一直没用到过的东西，之前版本忘了删了），从站不使用wifi，不需要这个。

#### V0.2.4更新

1. 添加宏定义，使未来修改一些参数更方便，包括

    ```
    #define SleepTime 4e6           // 休眠到唤醒并检测一次压力之间间隔的时间，即休眠时长
    #define CheckNumber 3           // 在IfIntoSleep函数（用于判断是否休眠）中，检测压力次数
    #define CheckIntervalTime 100   // 在IfIntoSleep函数（用于判断是否休眠）中，两次检测压力之间间隔的时间，单位毫秒
                                    // 检测压力次数与间隔的时间相乘即为IfIntoSleep函数中延迟的时间
    #define PressureThreshold 200   // 在IfIntoSleep函数（用于判断是否休眠）中，压力的阈值，检测到的压力（检测的数据在未调整下为0~1023）小于此值，则判断为应该进入休眠
    #define LoopDelay 200           // 在loop最后，延迟的时间 \
                                    // ESPNOW发送一次数据间隔时间为 (CheckNumber × CheckIntervalTime) ＋ LoopDelay
    ```

2. 修正在V0.2.3删除的wifi接入信息删除原因，这是在不再使用且已经注释掉的函数getWiFiChannel中使用的。若需要调用此函数，需要将wifi接入信息添加回来，请到V0.2.2中查阅相关代码。

#### V0.2.4更新

1. 删除了用于获取使用的信道的 getWiFiChannel 函数。若将来需要调用此函数，请到V0.2.2中查阅相关代码。

2. 对 loop 函数后跟的延迟做出调整，满足发送站发送请求的频率需求。 